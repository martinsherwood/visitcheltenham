function setStorage(){indexedDB||window.indexedDB||window.webkitIndexedDB||window.mozIndexedDB||window.OIndexedDB||window.msIndexedDB;indexedDB?store.setDriver("IndexedDBWrapper").then(function(){console.log(store.driver+" IndexedDB")}):window.openDatabase?store.setDriver("WebSQLWrapper").then(function(){console.log(store.driver+" WebSQL")}):store.setDriver("localStorageWrapper").then(function(){console.log(store.driver+" LocalStorage")}),window.storeConfig={name:"visit_cheltenham_app",version:1,size:4980736,storeName:"vc_storage",description:"Config settings and other application data"}}function getSettings(){store.getItem("searchSettings").then(function(e){searchRadius=parseInt(e[0].searchRadius),"walking"==e[1].travelMode?travelMode=google.maps.TravelMode.WALKING:"bicycling"==e[1].travelMode?travelMode=google.maps.TravelMode.BICYCLING:"driving"==e[1].travelMode&&(travelMode=google.maps.TravelMode.DRIVING),"imperial"==e[2].unitSystem?unitSystem=google.maps.UnitSystem.IMPERIAL:"metric"==e[2].unitSystem&&(unitSystem=google.maps.UnitSystem.METRIC)}),store.getItem("userAccount").then(function(e){userName=e[0].userName,userEmail=e[1].userEmail,userPassword=e[2].userPassword})}function getID(){store.getItem("userAccount").then(function(e){name=e[0].userName}),$.ajax({type:"POST",data:{username:name},url:serverURL+"getuser.php",async:!1,success:function(e){userID=e},error:function(){console.log("Failed to get user id, probably there is no match for the given username in the database.")}}),console.log("User ID Function: "+userID)}function backButton(){console.log("backbutton"),navigator.notification.confirm("Exit?",function(e){1==e&&navigator.app.exitApp()},"Exit","Yes, No")}function reloadApp(){location.reload(!0)}var serverURL="http://www.martinsherwood.co.uk/visitcheltenham/",searchRadius,travelMode,unitSystem,userName,userEmail,userPassword,offerCount=0,name,userID,app={initialize:function(){this.bindEvents()},bindEvents:function(){document.addEventListener("deviceready",this.onDeviceReady,!1),document.addEventListener("backbutton",backButton,!1)},onDeviceReady:function(){setStorage(),getSettings()},report:function(e){console.log("report:"+e)}};$(function(){store.getItem("userAccount").then(function(e){name=e[0].userName}),$.ajax({type:"POST",data:{username:name},url:serverURL+"getuser.php",async:!1,success:function(e){userID=e},error:function(){console.log("Failed to get user id, probably there is no match for the given username in the database.")}}),console.log("User ID: "+userID)});var header='<header role="banner" data-role="header" class="app-header container inner-wrap"><div role="button" data-role="button" class="menu-stack push"></div><nav role="navigation" data-role="navbar" class="main-menu menu-closed"><div class="nav-links"><a data-goto="#search" data-push="page" data-get="settings" data-user="userid"><i class="fa fa-border fa-search"></i>Search</a><a data-goto="#favourites" data-push="page" data-get="favourites" data-user="userid"><i class="fa fa-border fa-star"></i>Favourites</a><a data-goto="#offers" data-push="page"><i class="fa fa-border fa-shopping-cart"></i>Offers<span id="offer-count"></span></a><a data-goto="#settings" data-push="page"><i class="fa fa-border fa-cog"></i>Settings</a></div></nav><div role="button" data-role="button" class="locate-button"></div></header>';$("body").prepend(header),$(function(){var e=$(".main-menu"),t=$("body"),o=$("#container"),n=$(".push"),a=$(".overlay"),s="menu-open",r="push-active",i="container-push",l="pushed",c=$(".menu-stack");app=$("#app"),handle="goto";var p=function(){t.toggleClass(r),e.toggleClass(s),o.toggleClass(i),n.toggleClass(l)};Modernizr.csstransforms3d&&(c.hammer().on("tap",function(e){e.stopPropagation(),e.preventDefault(),p()}),a.hammer().on("tap",function(e){e.stopPropagation(),e.preventDefault(),p()})),$currentPage=0===$("#app > .current").length?$("#offers").addClass("current"):$("#app > .current"),$('[data-push="page"]').hammer().on("tap",function(e){e.stopPropagation(),e.preventDefault(),p();var t=$(app).find(".current"),o=$(this).data(handle);$(t).removeClass("current"),$(o).addClass("current")})}),function(){var e,t,o,n,a,s=$(".results-names"),r=$(".results-details"),i=$(".results h1"),l=new google.maps.LatLng(51.902707,-2.073361),c=[{featureType:"road",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"labels.text",stylers:[{visibility:"off"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#a2daf2"}]},{featureType:"landscape.man_made",elementType:"geometry",stylers:[{color:"#f7f1df"}]},{featureType:"landscape.natural",elementType:"geometry",stylers:[{color:"#d0e3b4"}]},{featureType:"landscape.natural.terrain",elementType:"geometry",stylers:[{visibility:"off"}]},{featureType:"poi.park",elementType:"geometry",stylers:[{color:"#bde6ab"}]},{featureType:"poi.medical",elementType:"geometry",stylers:[{color:"#fbd3da"}]},{featureType:"road",elementType:"geometry.stroke",stylers:[{visibility:"off"}]},{featureType:"road.highway",elementType:"geometry.fill",stylers:[{color:"#ffe15f"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#efd151"}]},{featureType:"road.arterial",elementType:"geometry.fill",stylers:[{color:"#ffffff"}]},{featureType:"road.local",elementType:"geometry.fill",stylers:[{color:"black"}]},{featureType:"transit.station.airport",elementType:"geometry.fill",stylers:[{color:"#cfb2db"}]}];getSettings(),$(function(){Modernizr.geolocation?GMaps.geolocate({success:function(e){var e={lat:e.coords.latitude,lng:e.coords.longitude};n=new google.maps.LatLng(e.lat,e.lng)},error:function(e){$(".location-map").append('<p class="no-geo message warning">Sorry, we failed to get your current location.</p>'),console.log(e.message)}}):noGeo()}),$(function(){function p(){Modernizr.geolocation?GMaps.geolocate({success:function(a){var a={lat:a.coords.latitude,lng:a.coords.longitude};n=new google.maps.LatLng(a.lat,a.lng),console.log("locate button, currentLocation: "+n),f(),t&&e&&(t.setMap(null),e.setMap(null)),o.addMarker({lat:a.lat,lng:a.lng,icon:"img/location-marker-blue.png",animation:google.maps.Animation.DROP}),o.setCenter(a.lat,a.lng),o.setZoom(16),$(".no-results").remove()},error:function(e){d(),console.log("Geolocation failed: "+e.message)}}):(u(),console.log("This browser/device does not support geolocation"))}function d(){$(".location-map").append('<p class="no-geo message warning">Sorry, this feature isn\'t available right now.</p>'),setTimeout(function(){$(".no-geo").remove()},3500)}function u(){$(".location-map").append('<p class="no-geo message warning">Sorry, this feature isn\'t supported on your device.</p>')}function f(){o.removeMarkers()}function m(){s.html(""),r.html(""),f(),$(".no-results").remove(),o.setZoom(14),t&&e&&(t.setMap(null),e.setMap(null))}return Modernizr.geolocation?(o=new GMaps({div:"#map-container",center:l,zoom:14,disableDefaultUI:!0,styles:c}),$(".locate-button").hammer().on("tap",function(e){e.stopPropagation(),e.preventDefault(),Modernizr.geolocation?p():d()}),$('[data-action="submit-place-search"]').hammer().on("tap",function(e){e.stopPropagation(),e.preventDefault(),$("#place-search").submit()}),$("#place-search").submit(function(c){c.stopPropagation(),c.preventDefault();var p=$("#place-query").val();return""==p?($("#place-query").focus(),$("#place-query").attr("placeholder","You didn't enter any terms")&&$("#place-query").addClass("plc-warning"),setTimeout(function(){$("#place-query").attr("placeholder","Search for places")&&$("#place-query").removeClass("plc-warning")},2800),!1):(o.addLayer("places",{location:l,radius:searchRadius,query:p,sensor:!0,language:"en-GB",textSearch:function(c,p){function d(e,t){if(t!=google.maps.DistanceMatrixStatus.OK)return!1;for(var o=e.originAddresses,n=e.destinationAddresses,a=0;a<o.length;a++)for(var s=e.rows[a].elements,i=0;i<s.length;i++){{var l=s[i],c=l.distance.text,p=l.duration.text;o[a],n[i]}r.append('<li data-animate="place-details" data-distance="'+c+'"data-duration="'+p+'">'+c+"</li>")}}if(p==google.maps.places.PlacesServiceStatus.OK){m();for(var u=new google.maps.LatLngBounds,f=0;f<c.length;f++){var g=c[f],h={url:g.icon,size:new google.maps.Size(71,71),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(17,34),scaledSize:new google.maps.Size(20,20)};s.append('<li data-animate="place-name" data-placename="'+g.name+'"><span class="placename">'+g.name+'</span><div class="options"><div class="opt"><div data-destination="'+g.formatted_address+'" id="get-directions" class="directions-button"></div></div><div class="opt"><div data-placename="'+g.name+'" data-address="'+g.formatted_address+'" id="add-favourite" class="add-favourite-button"></div></div></div></li>'),a=n;var v=g.geometry.location,w=new google.maps.DistanceMatrixService;w.getDistanceMatrix({origins:[a],destinations:[v],travelMode:travelMode,unitSystem:unitSystem,avoidHighways:!1,avoidTolls:!1},d),o.addMarker({lat:g.geometry.location.lat(),lng:g.geometry.location.lng(),icon:h,animation:google.maps.Animation.DROP,title:g.name,infoWindow:{content:'<h2 class="iw-heading">'+g.name+'</h2><p class="iw-address">'+(g.vicinity?g.vicinity:g.formatted_address)+"</p>"}}),u.extend(g.geometry.location)}o.fitBounds(u),e=o.drawCircle({center:l,radius:4,strokeColor:"#00adef",strokeOpacity:1,strokeWeight:8,fillColor:"#00adef",fillOpacity:1}),t=o.drawCircle({center:l,radius:searchRadius,strokeColor:"#00adef",strokeOpacity:1,strokeWeight:1,fillColor:"#808080",fillOpacity:.28})}else p==google.maps.places.PlacesServiceStatus.ZERO_RESULTS?(console.log(p),m(),i.after('<p class="warning no-results">Sorry, no places were found matching your search.</p>')):p==google.maps.places.PlacesServiceStatus.INVALID_REQUEST&&console.log(p)}}),r.hammer().on("tap","li",function(e){e.stopPropagation(),e.preventDefault();var t=$(this),o=$(this).data("distance"),n=$(this).data("duration");t.text()==o?t.text(n):t.text(o)}),google.maps.event.addListener(o,"bounds_changed",function(){var e=o.getBounds();$("#place-query").setBounds(e)}),void 0)}),void 0):(u(),!1)}),$(function(){var e,t,o,a='<div id="directions-box" class="modal-window"><h1 class="inner-wrap" data-transition="slide-down-in">Directions<div id="close-directions" class="close-modal"></div></h1><div id="directions-list"></div></div>';$(".results-names").hammer().on("swipeleft tap","li",function(e){e.stopPropagation(),e.preventDefault(),$(this).children("span").toggleClass("swiped"),$(this).children("div").toggleClass("shown")}),$(".results-names").hammer().on("tap","#add-favourite",function(o){o.stopPropagation(),o.preventDefault(),e=$(this).data("placename"),t=$(this).data("address"),$.ajax({context:this,type:"POST",data:{userid:userID,placename:e,placeaddress:t},url:serverURL+"addfavourite.php",beforeSend:function(){console.log("adding to favourites")},success:function(){$(this).attr("id","remove-favourite"),$(this).addClass("remove-favourite-button"),console.log("added "+e+" to favourites")},error:function(){console.log("error: "+this)}})}),$(".results-names").hammer().on("tap","#remove-favourite",function(t){t.stopPropagation(),t.preventDefault(),e=$(this).data("placename"),$.ajax({context:this,type:"POST",data:{userid:userID,placename:e},url:serverURL+"removefavourite.php",beforeSend:function(){console.log("deleting from favourites")},success:function(){$(this).attr("id","add-favourite"),$(this).removeClass("remove-favourite-button"),console.log("deleted "+e+" from favourites")},error:function(){console.log("There was a problem processing your request.")}})}),$(".results-names").hammer().on("tap","#get-directions",function(e){e.stopPropagation(),e.preventDefault(),$("#search").removeClass("current"),$("body").prepend(a),o=$(this).data("destination");var t=document.getElementById("directions-list"),s=new google.maps.DirectionsService,r=new google.maps.DirectionsRenderer;r.setPanel(t),s.route({origin:n,destination:o,travelMode:travelMode,unitSystem:unitSystem},function(e,t){t===google.maps.DirectionsStatus.OK&&r.setDirections(e)}),$("#close-directions").hammer().on("tap",function(e){e.stopPropagation(),e.preventDefault(),$("#directions-box").remove(),$("#search").addClass("current")})})})}(),$(function(){function e(){$.ajax({type:"POST",data:{userid:userID},url:serverURL+"getfavourites.php",async:!0,beforeSend:function(){n.append('<p class="message getting">Getting your favourites...<br><i class="fa fa-2x fa-spinner fa-spin"></i></p>')},success:function(e){$(".getting").remove(),objects=JSON.parse(e),$.each(objects,function(e,t){n.append('<li class="entry" data-animate="favourite" data-place="'+t+'"><span class="place-count">'+a+'</span><span class="place">'+t+'</span><div class="more"><div class="p-action"><div data-place="'+t+'" id="comment-place" class="comment-place-button"></div></div><div class="p-action"><div data-place="'+t+'" id="share-place" class="share-place-button"></div></div><div class="p-action"><div data-place="'+t+'" id="delete-favourite" class="delete-place-button"></div></div></div></li>'),a++}),$("#refresh-favourites").removeClass("fa-spin")},error:function(){console.log("oh no")}})}function t(){n.html(""),a=1}{var o,n=$(".favourites-list"),a=1,s='<div id="comments-box" class="modal-window"><h1 class="inner-wrap" data-transition="slide-down-in">Comments<div id="close-comments" class="close-modal"></div></h1><div class="add-comment"><form id="place-comment" method="post"><textarea id="comment" name="comment" placeholder="Enter a comment" autocorrect="on" autocapitalize="on" maxlength="180"></textarea><div id="post-comment" class="comments-button inner-wrap">Post Comment<div class="submit-icon"></div></div></form></div><div id="comments-list" class="inner-wrap"></div></div>';$("#comments-list")}$("#refresh-favourites").hammer().on("tap",function(o){o.stopPropagation(),o.preventDefault(),$(this).addClass("fa-spin"),console.log("refreshing"),t(),e()}),n.hammer().on("swipeleft tap","li",function(e){e.stopPropagation(),e.preventDefault(),$(this).children("span").toggleClass("swiped"),$(this).children("div").toggleClass("shown")}),n.hammer().on("tap","#comment-place",function(e){e.stopPropagation(),e.preventDefault(),$(".comment-error").remove(),o=$(this).data("place"),$("#favourites").removeClass("current"),$("body").prepend(s),$.ajax({type:"POST",data:{placename:o},url:serverURL+"getcomments.php",async:!0,beforeSend:function(){$("#comments-list").append('<p class="message getting">Getting comments...<br><i class="fa fa-2x fa-spinner fa-spin"></i></p>')},success:function(e){$(".getting").remove(),objects=JSON.parse(e),$.each(objects,function(e,t){$("#comments-list").append('<div data-animate="comment" class="comment"><span class="by">'+t.username+'<span class="on">'+t.date+"</span></span><p>"+t.comment+"</p></div>")})},error:function(){$(".getting").remove(),$("#comments-list").append('<p class="warning comment-error">Sorry, there was an error getting the comments.</p>')}}),$("#comment").focus(function(){$("#comments-list").addClass("making-comment"),$("#comment").blur(function(){$("#comments-list").removeClass("making-comment")})}),$("#post-comment").hammer().on("tap",function(e){e.stopPropagation(),e.preventDefault(),$("#place-comment").submit()}),$("#place-comment").submit(function(e){e.stopPropagation(),e.preventDefault();var t=$("#comment").val();return""==t?($("#comment").focus(),$("#comment").attr("placeholder","You didn't enter a comment")&&$("#comment").addClass("plc-warning"),setTimeout(function(){$("#comment").attr("placeholder","Enter a comment")&&$("#comment").removeClass("plc-warning")},2800),!1):($(".comment-error").remove(),$.ajax({context:this,type:"POST",data:{userid:userID,username:userName,placename:o,comment:t},url:serverURL+"comment.php",async:!0,beforeSend:function(){$("#place-comment").append('<p class="message success prominent posting">Posting comment...<br><i class="fa fa-2x fa-spinner fa-spin"></i></p>')},success:function(){$(".posting").remove(),$("#place-comment").append('<p class="message success prominent timed">Your comment has been posted.</p>'),setTimeout(function(){$(".timed").remove(),$("#comments-list").prepend('<div data-animate="comment" class="comment"><p><span class="by">'+userName+"</span>"+t+"</p></div>"),$("#comment").val("")},3500)},error:function(){$("#place-comment").append('<p class="warning comment-error">Sorry, there was an error getting the comments.</p>')}}),void 0)}),$("#comments-list").hammer().on("tap",".comment",function(e){e.stopPropagation(),e.preventDefault(),$("p",this).toggleClass("expanded")}),$("#close-comments").hammer().on("tap",function(e){e.stopPropagation(),e.preventDefault(),$("#comments-box").remove(),$("#favourites").addClass("current")})}),n.hammer().on("tap","#share-place",function(e){e.stopPropagation(),e.preventDefault(),o=$(this).data("place"),window.location.href="mailto:?subject=Check this place out!&body=Hey, I found this really good place called, "+o+"."}),n.hammer().on("tap","#delete-favourite",function(e){e.stopPropagation(),e.preventDefault(),o=$(this).data("place"),$.ajax({context:this,type:"POST",data:{userid:userID,placename:o},url:serverURL+"removefavourite.php",beforeSend:function(){console.log("deleting from favourites")},success:function(){$(this).parents("div div li.entry").remove(),console.log("deleted "+o+" from favourites")}})}),$('[data-get="favourites"]').hammer().on("tap",function(o){o.stopPropagation(),o.preventDefault(),t(),e()})}),$(function(){function e(){return $.ajax({url:serverURL+"getoffers.php",async:!0,beforeSend:function(){console.log("getting offers"),$(".offer-roll").append('<p class="message getting">Getting offers...<br><i class="fa fa-2x fa-spinner fa-spin"></i></p>')},success:function(){$(".getting").remove()},error:function(){$("#place-comment").append('<p class="warning comment-error">Sorry, there was an error getting the comments.</p>'),console.log("failed to get offers")}})}function t(e){objects=JSON.parse(e),$.each(objects,function(e,t){offerCount++,offerCount>99?offerCount=99:(0>offerCount||0==offerCount)&&(offerCount=0),console.log(t),$(".roller").append('<div class="offer-container"><div class="offer-image" style="background:url('+o+t.imagename+'); background-size: cover"></div><h2 class="inner-wrap">'+t.placename+"</h2><p>"+t.description+'</p><div data-action="redeem-offer" class="redeem" data-code="'+t.code+'">Get Offer</div><span class="code">'+t.code+'</span><span class="expiry">'+t.expiry+"</span></div>")}),$("#offer-count").html(offerCount)}var o="http://www.martinsherwood.co.uk/visitcheltenham/offerimages/";e().done(t);var n=function(e,t){"use strict";function o(){var e=u-g;return t.slidesPerView>c.slides.length&&!t.centeredSlides&&(e=0),0>e&&(e=0),e}function n(){var e=c.h.addEventListener,o="wrapper"===t.eventTarget?c.wrapper:c.container;c.browser.ie10||c.browser.ie11?(e(o,c.touchEvents.touchStart,a),e(document,c.touchEvents.touchMove,s),e(document,c.touchEvents.touchEnd,r)):(c.support.touch&&(e(o,"touchstart",a),e(o,"touchmove",s),e(o,"touchend",r)),t.simulateTouch&&(e(o,"mousedown",a),e(document,"mousemove",s),e(document,"mouseup",r)))}function a(e){if(t.preventLinks&&(c.allowLinks=!0),c.isTouched||t.onlyExternal)return!1;if(t.noSwiping&&(e.target||e.srcElement)&&noSwipingSlide(e.target||e.srcElement))return!1;if(C=!1,c.isTouched=!0,M="touchstart"===e.type,!M||1===e.targetTouches.length){c.callPlugins("onTouchStartBegin"),M||c.isAndroid||(e.preventDefault?e.preventDefault():e.returnValue=!1);var o=M?e.targetTouches[0].pageX:e.pageX||e.clientX,n=M?e.targetTouches[0].pageY:e.pageY||e.clientY;c.touches.startX=c.touches.currentX=o,c.touches.startY=c.touches.currentY=n,c.touches.start=c.touches.current=y?o:n,c.setWrapperTransition(0),c.positions.start=c.positions.current=c.getWrapperTranslate(),c.setWrapperTranslate(c.positions.start),c.times.start=(new Date).getTime(),m=void 0,t.moveStartThreshold>0&&(D=!1),t.onTouchStart&&c.fireCallback(t.onTouchStart,c,e),c.callPlugins("onTouchStartEnd")}}function s(e){if(c.isTouched&&!t.onlyExternal&&(!M||"mousemove"!==e.type)){var n=M?e.targetTouches[0].pageX:e.pageX||e.clientX,a=M?e.targetTouches[0].pageY:e.pageY||e.clientY;if("undefined"==typeof m&&y&&(m=!!(m||Math.abs(a-c.touches.startY)>Math.abs(n-c.touches.startX))),"undefined"!=typeof m||y||(m=!!(m||Math.abs(a-c.touches.startY)<Math.abs(n-c.touches.startX))),m)return c.isTouched=!1,void 0;if(e.assignedToSwiper)return c.isTouched=!1,void 0;if(e.assignedToSwiper=!0,t.preventLinks&&(c.allowLinks=!1),t.onSlideClick&&(c.allowSlideClick=!1),t.autoplay&&c.stopAutoplay(!0),!M||1===e.touches.length){if(c.isMoved||(c.callPlugins("onTouchMoveStart"),t.loop&&(c.fixLoop(),c.positions.start=c.getWrapperTranslate()),t.onTouchMoveStart&&c.fireCallback(t.onTouchMoveStart,c)),c.isMoved=!0,e.preventDefault?e.preventDefault():e.returnValue=!1,c.touches.current=y?n:a,c.positions.current=(c.touches.current-c.touches.start)*t.touchRatio+c.positions.start,c.positions.current>0&&t.onResistanceBefore&&c.fireCallback(t.onResistanceBefore,c,c.positions.current),c.positions.current<-o()&&t.onResistanceAfter&&c.fireCallback(t.onResistanceAfter,c,Math.abs(c.positions.current+o())),t.resistance&&"100%"!==t.resistance){var s;if(c.positions.current>0&&(s=1-c.positions.current/g/2,c.positions.current=.5>s?g/2:c.positions.current*s),c.positions.current<-o()){var r=(c.touches.current-c.touches.start)*t.touchRatio+(o()+c.positions.start);s=(g+r)/g;var i=c.positions.current-r*(1-s)/2,l=-o()-g/2;c.positions.current=l>i||0>=s?l:i}}if(!t.followFinger)return;if(t.moveStartThreshold)if(Math.abs(c.touches.current-c.touches.start)>t.moveStartThreshold||D){if(!D)return D=!0,c.touches.start=c.touches.current,void 0;c.setWrapperTranslate(c.positions.current)}else c.positions.current=c.positions.start;else c.setWrapperTranslate(c.positions.current);return!1}}}function r(e){if(m&&c.swipeReset(),!t.onlyExternal&&c.isTouched){c.isTouched=!1,c.positions.current||0===c.positions.current||(c.positions.current=c.positions.start),t.followFinger&&c.setWrapperTranslate(c.positions.current),c.times.end=(new Date).getTime(),c.touches.diff=c.touches.current-c.touches.start,c.touches.abs=Math.abs(c.touches.diff),c.positions.diff=c.positions.current-c.positions.start,c.positions.abs=Math.abs(c.positions.diff);var n=c.positions.diff,a=c.positions.abs,s=c.times.end-c.times.start;5>a&&300>s&&c.allowLinks===!1&&(0!==a&&c.swipeReset(),t.preventLinks&&(c.allowLinks=!0),t.onSlideClick&&(c.allowSlideClick=!0)),setTimeout(function(){t.preventLinks&&(c.allowLinks=!0),t.onSlideClick&&(c.allowSlideClick=!0)},100);var r=o();if(!c.isMoved)return c.isMoved=!1,t.onTouchEnd&&c.fireCallback(t.onTouchEnd,c,e),c.callPlugins("onTouchEnd"),void 0;if(!c.isMoved||c.positions.current>0||c.positions.current<-r)return c.swipeReset(),t.onTouchEnd&&c.fireCallback(t.onTouchEnd,c,e),c.callPlugins("onTouchEnd"),void 0;c.isMoved=!1,f=0>n?"toNext":"toPrev","toNext"===f&&300>=s&&(30>a||!t.shortSwipes?c.swipeReset():c.swipeNext(!0)),"toPrev"===f&&300>=s&&(30>a||!t.shortSwipes?c.swipeReset():c.swipePrev(!0));var i=0;if("auto"===t.slidesPerView){for(var l,p=Math.abs(c.getWrapperTranslate()),u=0,h=0;h<c.slides.length;h++)if(l=y?c.slides[h].getWidth(!0,t.roundLengths):c.slides[h].getHeight(!0,t.roundLengths),u+=l,u>p){i=l;break}i>g&&(i=g)}else i=d*t.slidesPerView;"toNext"===f&&s>300&&(a>=i*t.longSwipesRatio?c.swipeNext(!0):c.swipeReset()),"toPrev"===f&&s>300&&(a>=i*t.longSwipesRatio?c.swipePrev(!0):c.swipeReset()),t.onTouchEnd&&c.fireCallback(t.onTouchEnd,c,e),c.callPlugins("onTouchEnd")}}function i(e,o,n){var a="to"===o&&n.speed>=0?n.speed:t.speed;+new Date,c.support.transitions&&(c.setWrapperTranslate(e),c.setWrapperTransition(a))}function l(){c.calcSlides(),t.loop&&c.createLoop(),c.init(),n(),c.centerIndex=c.activeIndex}var c=this;c.touches={start:0,startX:0,startY:0,current:0,currentX:0,currentY:0,diff:0,abs:0},c.positions={start:0,abs:0,diff:0,current:0},c.times={start:0,end:0},c.id=(new Date).getTime(),c.container=e.nodeType?e:$$(e)[0],c.isTouched=!1,c.isMoved=!1,c.activeIndex=0,c.centerIndex=0,c.activeLoaderIndex=0,c.activeLoopIndex=0,c.previousIndex=null,c.velocity=0,c.snapGrid=[],c.slidesGrid=[],c.imagesToLoad=[],c.imagesLoaded=0,c.wrapperLeft=0,c.wrapperRight=0,c.wrapperTop=0,c.wrapperBottom=0,c.isAndroid=navigator.userAgent.toLowerCase().indexOf("android")>=0;var p,d,u,f,m,g,h={mode:"horizontal",touchRatio:1,speed:600,momentumRatio:1,momentumBounce:!0,momentumBounceRatio:1,slidesPerView:1,slidesPerGroup:1,slidesPerViewFit:!0,simulateTouch:!0,followFinger:!0,shortSwipes:!0,longSwipesRatio:.5,moveStartThreshold:!1,onlyExternal:!1,resistance:!0,scrollContainer:!1,preventLinks:!0,preventLinksPropagation:!1,initialSlide:0,useCSS3Transforms:!0,roundLengths:!1,calculateHeight:!1,cssWidthAndHeight:!1,visibilityFullFit:!1,offsetPxBefore:0,offsetPxAfter:0,offsetSlidesBefore:0,offsetSlidesAfter:0,centeredSlides:!1,autoResize:!1,resizeReInit:!1,slideElement:"div",slideClass:"offer-container",wrapperClass:"roller"};t=t||{};for(var v in h)if(v in t&&"object"==typeof t[v])for(var w in h[v])w in t[v]||(t[v][w]=h[v][w]);else v in t||(t[v]=h[v]);c.params=t;var y="horizontal"===t.mode,$=["mousedown","mousemove","mouseup"];c.browser.ie10&&($=["MSPointerDown","MSPointerMove","MSPointerUp"]),c.browser.ie11&&($=["pointerdown","pointermove","pointerup"]),c.touchEvents={touchStart:c.support.touch||!t.simulateTouch?"touchstart":$[0],touchMove:c.support.touch||!t.simulateTouch?"touchmove":$[1],touchEnd:c.support.touch||!t.simulateTouch?"touchend":$[2]};for(var T=c.container.childNodes.length-1;T>=0;T--)if(c.container.childNodes[T].className)for(var b=c.container.childNodes[T].className.split(/\s+/),S=0;S<b.length;S++)b[S]===t.wrapperClass&&(p=c.container.childNodes[T]);c.wrapper=p,c._extendSwiperSlide=function(e){return e.append=function(){return t.loop?e.insertAfter(c.slides.length-c.loopedSlides):(c.wrapper.appendChild(e),c.reInit()),e},e.prepend=function(){return t.loop?(c.wrapper.insertBefore(e,c.slides[c.loopedSlides]),c.removeLoopedSlides(),c.calcSlides(),c.createLoop()):c.wrapper.insertBefore(e,c.wrapper.firstChild),c.reInit(),e},e.insertAfter=function(o){if("undefined"==typeof o)return!1;var n;return t.loop?(n=c.slides[o+1+c.loopedSlides],n?c.wrapper.insertBefore(e,n):c.wrapper.appendChild(e),c.removeLoopedSlides(),c.calcSlides(),c.createLoop()):(n=c.slides[o+1],c.wrapper.insertBefore(e,n)),c.reInit(),e},e.html=function(t){return"undefined"==typeof t?e.innerHTML:(e.innerHTML=t,e)},e.index=function(){for(var t,o=c.slides.length-1;o>=0;o--)e===c.slides[o]&&(t=o);return t},e.getWidth=function(t,o){return c.h.getWidth(e,t,o)},e.getHeight=function(t,o){return c.h.getHeight(e,t,o)},e.getOffset=function(){return c.h.getOffset(e)},e},c.calcSlides=function(){c.slides?c.slides.length:!1,c.slides=[],c.displaySlides=[];for(var e=0;e<c.wrapper.childNodes.length;e++)if(c.wrapper.childNodes[e].className)for(var o=c.wrapper.childNodes[e].className,n=o.split(/\s+/),a=0;a<n.length;a++)n[a]===t.slideClass&&c.slides.push(c.wrapper.childNodes[e])};var x=[];for(var P in c.plugins)if(t[P]){var k=c.plugins[P](c,t[P]);k&&x.push(k)}c.callPlugins=function(e,t){t||(t={});for(var o=0;o<x.length;o++)e in x[o]&&x[o][e](t)},!c.browser.ie10&&!c.browser.ie11||t.onlyExternal||c.wrapper.classList.add("wp8-"+(y?"horizontal":"vertical")),c.initialized=!1,c.init=function(e,o){var n=c.h.getWidth(c.container,!1,t.roundLengths),a=c.h.getHeight(c.container,!1,t.roundLengths);if(n!==c.width||a!==c.height||e){c.width=n,c.height=a;var s,r,i,l,p,f,m;g=y?n:a;var h=c.wrapper;if(e)c.calcSlides(o);else{if(t.calculateHeight){for(i=0,p=0,y||(c.container.style.height=""),h.style.height="",m=0;m<c.slides.length;m++)c.slides[m].style.height="",i=Math.max(c.slides[m].getHeight(!0),i),y||(p+=c.slides[m].getHeight(!0));r=i,c.height=r,y?p=r:(g=r,c.container.style.height=g+"px")}else r=y?c.height:c.height/t.slidesPerView,t.roundLengths&&(r=Math.round(r)),p=y?c.height:c.slides.length*r;for(s=y?c.width/t.slidesPerView:c.width,t.roundLengths&&(s=Math.round(s)),l=y?c.slides.length*s:c.width,d=y?s:r,u=y?l+c.wrapperRight+c.wrapperLeft:p+c.wrapperTop+c.wrapperBottom,t.cssWidthAndHeight||(parseFloat(l)>0&&(h.style.width=l+"px"),parseFloat(p)>0&&(h.style.height=p+"px")),f=0,c.snapGrid=[],c.slidesGrid=[],m=0;m<c.slides.length;m++)c.snapGrid.push(f),c.slidesGrid.push(f),f+=d,t.cssWidthAndHeight||(parseFloat(s)>0&&(c.slides[m].style.width=s+"px"),parseFloat(r)>0&&(c.slides[m].style.height=r+"px"))}c.initialized=!0}},c.reInit=function(e){c.init(!0,e)};var D,M=!1,C=!0;c.swipeNext=function(e){!e&&t.loop&&c.fixLoop(),!e&&t.autoplay&&c.stopAutoplay(!0),c.callPlugins("onSwipeNext");var n=c.getWrapperTranslate(),a=n;if("auto"===t.slidesPerView){for(var s=0;s<c.snapGrid.length;s++)if(-n>=c.snapGrid[s]&&-n<c.snapGrid[s+1]){a=-c.snapGrid[s+1];break}}else{var r=d*t.slidesPerGroup;a=-(Math.floor(Math.abs(n)/Math.floor(r))*r+r)}return a<-o()&&(a=-o()),a===n?!1:(i(a,"next"),!0)},c.swipePrev=function(e){!e&&t.loop&&c.fixLoop(),!e&&t.autoplay&&c.stopAutoplay(!0),c.callPlugins("onSwipePrev");var o,n=Math.ceil(c.getWrapperTranslate());if("auto"===t.slidesPerView){o=0;for(var a=1;a<c.snapGrid.length;a++){if(-n===c.snapGrid[a]){o=-c.snapGrid[a-1];break}if(-n>c.snapGrid[a]&&-n<c.snapGrid[a+1]){o=-c.snapGrid[a];break}}}else{var s=d*t.slidesPerGroup;o=-(Math.ceil(-n/s)-1)*s}return o>0&&(o=0),o===n?!1:(i(o,"prev"),!0)},c.swipeReset=function(){c.callPlugins("onSwipeReset");var e,n=c.getWrapperTranslate(),a=d*t.slidesPerGroup;if(-o(),"auto"===t.slidesPerView){e=0;for(var s=0;s<c.snapGrid.length;s++){if(-n===c.snapGrid[s])return;if(-n>=c.snapGrid[s]&&-n<c.snapGrid[s+1]){e=c.positions.diff>0?-c.snapGrid[s+1]:-c.snapGrid[s];break}}-n>=c.snapGrid[c.snapGrid.length-1]&&(e=-c.snapGrid[c.snapGrid.length-1]),n<=-o()&&(e=-o())}else e=0>n?Math.round(n/a)*a:0;return t.scrollContainer&&(e=0>n?n:0),e<-o()&&(e=-o()),t.scrollContainer&&g>d&&(e=0),e===n?!1:(i(e,"reset"),!0)},c.swipeTo=function(e,n,a){e=parseInt(e,10),c.callPlugins("onSwipeTo",{index:e,speed:n}),t.loop&&(e+=c.loopedSlides);var s=c.getWrapperTranslate();if(!(e>c.slides.length-1||0>e)){var r;return r="auto"===t.slidesPerView?-c.slidesGrid[e]:-e*d,r<-o()&&(r=-o()),r===s?!1:(i(r,"to",{index:e,speed:n,runCallbacks:a}),!0)}},l()};n.prototype={wrapperTransitionEnd:function(){"use strict";var e=this;e.wrapper},getWrapperTranslate:function(e){"use strict";var t,o,n,a,s=this.wrapper;return"undefined"==typeof e&&(e="horizontal"===this.params.mode?"x":"y"),this.support.transforms&&this.params.useCSS3Transforms?(n=window.getComputedStyle(s,null),window.WebKitCSSMatrix?a=new WebKitCSSMatrix("none"===n.webkitTransform?"":n.webkitTransform):(a=n.MozTransform||n.OTransform||n.MsTransform||n.msTransform||n.transform||n.getPropertyValue("transform").replace("translate(","matrix(1, 0, 0, 1,"),t=a.toString().split(",")),"x"===e&&(o=window.WebKitCSSMatrix?a.m41:16===t.length?parseFloat(t[12]):parseFloat(t[4])),"y"===e&&(o=window.WebKitCSSMatrix?a.m42:16===t.length?parseFloat(t[13]):parseFloat(t[5]))):("x"===e&&(o=parseFloat(s.style.left,10)||0),"y"===e&&(o=parseFloat(s.style.top,10)||0)),o||0},setWrapperTranslate:function(e,t,o){"use strict";var n,a=this.wrapper.style,s={x:0,y:0,z:0};3===arguments.length?(s.x=e,s.y=t,s.z=o):("undefined"==typeof t&&(t="horizontal"===this.params.mode?"x":"y"),s[t]=e),this.support.transforms&&this.params.useCSS3Transforms?(n=this.support.transforms3d?"translate3d("+s.x+"px, "+s.y+"px, "+s.z+"px)":"translate("+s.x+"px, "+s.y+"px)",a.webkitTransform=a.MsTransform=a.msTransform=a.MozTransform=a.OTransform=a.transform=n):(a.left=s.x+"px",a.top=s.y+"px"),this.callPlugins("onSetWrapperTransform",s),this.params.onSetWrapperTransform&&this.fireCallback(this.params.onSetWrapperTransform,this,s)},setWrapperTransition:function(e){"use strict";var t=this.wrapper.style;t.webkitTransitionDuration=t.MsTransitionDuration=t.msTransitionDuration=t.MozTransitionDuration=t.OTransitionDuration=t.transitionDuration=e/1e3+"s",this.callPlugins("onSetWrapperTransition",{duration:e}),this.params.onSetWrapperTransition&&this.fireCallback(this.params.onSetWrapperTransition,this,e)
},h:{getWidth:function(e,t,o){"use strict";var n=window.getComputedStyle(e,null).getPropertyValue("width"),a=parseFloat(n);return(isNaN(a)||n.indexOf("%")>0)&&(a=e.offsetWidth-parseFloat(window.getComputedStyle(e,null).getPropertyValue("padding-left"))-parseFloat(window.getComputedStyle(e,null).getPropertyValue("padding-right"))),t&&(a+=parseFloat(window.getComputedStyle(e,null).getPropertyValue("padding-left"))+parseFloat(window.getComputedStyle(e,null).getPropertyValue("padding-right"))),o?Math.round(a):a},getHeight:function(e,t,o){"use strict";if(t)return e.offsetHeight;var n=window.getComputedStyle(e,null).getPropertyValue("height"),a=parseFloat(n);return(isNaN(a)||n.indexOf("%")>0)&&(a=e.offsetHeight-parseFloat(window.getComputedStyle(e,null).getPropertyValue("padding-top"))-parseFloat(window.getComputedStyle(e,null).getPropertyValue("padding-bottom"))),t&&(a+=parseFloat(window.getComputedStyle(e,null).getPropertyValue("padding-top"))+parseFloat(window.getComputedStyle(e,null).getPropertyValue("padding-bottom"))),o?Math.round(a):a},addEventListener:function(e,t,o,n){"use strict";"undefined"==typeof n&&(n=!1),e.addEventListener?e.addEventListener(t,o,n):e.attachEvent&&e.attachEvent("on"+t,o)}},setTransform:function(e,t){"use strict";var o=e.style;o.webkitTransform=o.MsTransform=o.msTransform=o.MozTransform=o.OTransform=o.transform=t},setTranslate:function(e,t){"use strict";var o=e.style,n={x:t.x||0,y:t.y||0,z:t.z||0},a=this.support.transforms3d?"translate3d("+n.x+"px,"+n.y+"px,"+n.z+"px)":"translate("+n.x+"px,"+n.y+"px)";o.webkitTransform=o.MsTransform=o.msTransform=o.MozTransform=o.OTransform=o.transform=a,this.support.transforms||(o.left=n.x+"px",o.top=n.y+"px")},setTransition:function(e,t){"use strict";var o=e.style;o.webkitTransitionDuration=o.MsTransitionDuration=o.msTransitionDuration=o.MozTransitionDuration=o.OTransitionDuration=o.transitionDuration=t+"ms"},support:{touch:window.Modernizr&&Modernizr.touch===!0||function(){"use strict";return!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch)}(),transforms3d:window.Modernizr&&Modernizr.csstransforms3d===!0||function(){"use strict";var e=document.createElement("div").style;return"webkitPerspective"in e||"MozPerspective"in e||"OPerspective"in e||"MsPerspective"in e||"perspective"in e}(),transforms:window.Modernizr&&Modernizr.csstransforms===!0||function(){"use strict";var e=document.createElement("div").style;return"transform"in e||"WebkitTransform"in e||"MozTransform"in e||"msTransform"in e||"MsTransform"in e||"OTransform"in e}(),transitions:window.Modernizr&&Modernizr.csstransitions===!0||function(){"use strict";var e=document.createElement("div").style;return"transition"in e||"WebkitTransition"in e||"MozTransition"in e||"msTransition"in e||"MsTransition"in e||"OTransition"in e}()},browser:{ie10:window.navigator.msPointerEnabled,ie11:window.navigator.pointerEnabled}},function(e){"use strict";e.fn.offerRoll=function(t){var o=new n(e(this)[0],t);return o}}($),$(function(){$(".offer-roll").offerRoll({mode:"horizontal",loop:!1})}),$(".roller").hammer().on("tap",".redeem",function(e){e.stopPropagation(),e.preventDefault();var t=$(this).data("code");console.log(t)})}),$(function(){$(".show-settings").hammer().on("tap",function(e){e.stopPropagation(),e.preventDefault();var t=$(this).data("show");$("#"+t).toggleClass("settings-shown"),$("i",this).toggleClass("fa-flip-vertical")}),$(function(){store.getItem("searchSettings").then(function(e){$("#search-radius").val(e[0].searchRadius),$('#travel-mode option[value="'+e[1].travelMode+'"]').attr("selected","selected"),$('#unit-system option[value="'+e[2].unitSystem+'"]').attr("selected","selected")}),$('[data-action="save-settings"]').hammer().on("tap",function(e){e.stopPropagation(),e.preventDefault(),$("#search-settings").submit()}),$("#search-settings").submit(function(e){e.stopPropagation(),e.preventDefault(),searchRadius=$("#search-radius").val(),travelMode=$("#travel-mode").val(),unitSystem=$("#unit-system").val();var t=[{searchRadius:searchRadius},{travelMode:travelMode},{unitSystem:unitSystem}];store.setItem("searchSettings",t).then(function(){$("#search-settings").append('<p class="message success prominent timed">Settings have been saved.</p>'),setTimeout(function(){$(".timed").remove(),getSettings()},3500)})})}),$(function(){var e={setToken:function(e){localStorage.access_token=e.access_token,localStorage.refresh_token=e.refresh_token||localStorage.refresh_token;var t=(new Date).getTime()+1e3*parseInt(e.expires_in,10)-6e4;localStorage.expires_at=t},authorize:function(e){function t(t){var n="undefined"!=typeof t.url?t.url:t.originalEvent.url,s=/\?code=(.+)$/.exec(n),r=/\?error=(.+)$/.exec(n);(s||r)&&a.close(),s?$.post("https://accounts.google.com/o/oauth2/token",{code:s[1],client_id:e.client_id,client_secret:e.client_secret,redirect_uri:e.redirect_uri,grant_type:"authorization_code"}).done(function(e){googleapi.setToken(e),o.resolve(e)}).fail(function(e){o.reject(e.responseJSON)}):r&&o.reject({error:r[1]})}var o=$.Deferred(),n="https://accounts.google.com/o/oauth2/auth?"+$.param({client_id:e.client_id,redirect_uri:e.redirect_uri,response_type:"code",scope:e.scope}),a=window.open(n,"_blank","location=no,toolbar=no");return a.addEventListener("loadstart",t),o.promise()},getToken:function(e){var t=$.Deferred();return(new Date).getTime()<localStorage.expires_at?t.resolve({access_token:localStorage.access_token}):localStorage.refresh_token?$.post("https://accounts.google.com/o/oauth2/token",{refresh_token:localStorage.refresh_token,client_id:e.client_id,client_secret:e.client_secret,grant_type:"refresh_token"}).done(function(e){googleapi.setToken(e),t.resolve(e)}).fail(function(e){t.reject(e.responseJSON)}):t.reject(),t.promise()},userInfo:function(e){return $.getJSON("https://www.googleapis.com/oauth2/v1/userinfo",e)}},t={client_id:"576726549275.apps.googleusercontent.com",client_secret:"7cELIkyAkF1a5ve-Z_6YoAhX",redirect_uri:"http://localhost",scope:"https://www.googleapis.com/auth/userinfo.profile",init:function(){$('[data-action="google-signin"]').hammer().on("tap",function(){t.LoginButton()}),e.getToken({client_id:app.client_id,client_secret:app.client_secret}).done(function(){t.showSuccessView()}).fail(function(){t.showLoginView()})},showLoginView:function(){$("#google-login").show(),$("#google-login-success").hide()},showSuccessView:function(){$("#google-login").hide(),$("#google-login-success").show(),e.getToken({client_id:t.client_id,client_secret:t.client_secret}).then(function(e){return googleapi.userInfo({access_token:e.access_token})}).done(function(e){$("#google-login-success p").html(e.name+" via Google")}).fail(function(){app.showLoginView()})},LoginButton:function(){e.authorize({client_id:t.client_id,client_secret:t.client_secret,redirect_uri:t.redirect_uri,scope:t.scope}).done(function(){t.showSuccessView()}).fail(function(e){$("#google-login p").html(e.error)})}};t.init()}),$(function(){store.getItem("userAccount").then(function(e){$("#username").val(e[0].userName),$("#useremail").val(e[1].userEmail),$("#userpassword").val(e[2].userPassword)}),$('[data-action="save-account"]').hammer().on("tap",function(e){e.stopPropagation(),e.preventDefault(),$("#user-account").submit()}),$("#user-account").submit(function(e){e.stopPropagation(),e.preventDefault(),userName=$("#username").val(),userEmail=$("#useremail").val(),userPassword=$("#userpassword").val();var t=[{userName:userName},{userEmail:userEmail},{userPassword:userPassword}],o=$(this).serialize();return""==userName||""==userEmail||""==userPassword?($("#user-account").append('<p class="message warning prominent timed">All fields are required.</p>'),setTimeout(function(){$(".timed").remove()},3500),!1):userName.match(/[_\W0-9]/)?($("#user-account").append('<p class="message warning prominent timed">Please only use alphabetical characters in your username, no spaces or special characters.</p>'),setTimeout(function(){$(".timed").remove()},3500),!1):0!=userID?(console.log("creation failed"),$("#user-account").append('<p class="message warning prominent timed">You have already made an account.</p>'),setTimeout(function(){$(".timed").remove()},3500),!1):(store.setItem("userAccount",t).then(function(){store.getItem("userAccount").then(function(e){name=e[0].userName,console.log("name from store: "+name)}),$.ajax({type:"POST",data:o,url:serverURL+"register.php",async:!1,beforeSend:function(){console.log("creating"),$("#user-account").append('<p class="message success prominent creating">Creating...<br><i class="fa fa-2x fa-spinner fa-spin"></i></p>')},success:function(){$(".creating").remove(),$("#user-account").append('<p class="message success prominent timed">Your account has been registed and saved.</p>'),setTimeout(function(){$(".timed").remove()},3500)}})}),void 0)})}),$(function(){$('[data-action="submit-postcode-lookup"]').hammer().on("tap",function(e){e.stopPropagation(),e.preventDefault(),$("#postcode-lookup").submit()}),$("#postcode-lookup").submit(function(e){return e.stopPropagation(),e.preventDefault(),""==$("#postcode").val()?($("#postcode").focus(),$("#postcode").attr("placeholder","No postcode entered")&&$("#postcode").addClass("plc-warning"),setTimeout(function(){$("#postcode").attr("placeholder","Enter a postcode")&&$("#postcode").removeClass("plc-warning")},2800),!1):(GMaps.geocode({address:$("#postcode").val().trim(),callback:function(e,t){if("OK"==t){var o=e[0].formatted_address;$(".geocode-result").text(o),$("#postcode").val("")}else $("#address").attr("placeholder","No results")&&$("#address").addClass("plc-warning"),setTimeout(function(){$("#address").attr("placeholder","Enter a postcode")&&$("#address").removeClass("plc-warning")},2800)}}),void 0)})}),$(function(){$('[data-action="send-feedback"]').hammer().on("tap",function(e){e.stopPropagation(),e.preventDefault(),$("#send-feedback").submit()}),$("#send-feedback").submit(function(e){if(e.stopPropagation(),e.preventDefault(),""==$("#name").val()||""==$("#email").val()||""==$("#message").val())$("#send-feedback").append('<p class="message warning prominent timed">Please fill out all fields.</p>'),setTimeout(function(){$(".timed").remove()},3500);else{var t=$(this).serialize();$.ajax({type:"POST",data:t,url:serverURL+"feedback.php",beforeSend:function(){$("#send-feedback").append('<p class="message success prominent sending">Sending...<br><i class="fa fa-2x fa-spinner fa-spin"></i></p>')},success:function(){$(".sending").remove(),$("#send-feedback").append('<p class="message success prominent timed">Thanks for the feedback!</p>'),setTimeout(function(){$(".timed").remove(),$("#name").val("")&&$("#email").val("")&&$("#message").val("")},3500)}})}})}),$(function(){$("#confirm-delete").change(function(){var e=$(this);e.prop("checked")?$(".delete-button").css("display","block"):$(".delete-button").css("display","none")}).change(function(){$('[data-action="delete-data"]').hammer().on("tap",function(e){e.stopPropagation(),e.preventDefault(),$("#confirm-delete").prop("checked")===!0&&(console.log("delete data button hit"),store.removeItem("searchSettings"),store.removeItem("userAccount"),$.ajax({type:"POST",data:{id:userID},url:serverURL+"deleteuser.php",async:!1,beforeSend:function(){$("#delete-data").append('<p class="message success prominent working">Working...<br><i class="fa fa-2x fa-spinner fa-spin"></i></p>')},success:function(){$(".working").remove(),$("#delete-data").append('<p class="message success prominent done">Your account and application data have been deleted, the app will now restart.</p>'),userID=0,setTimeout(function(){reloadApp()},4e3)},error:function(){console.log("Could not complete")}}))})})}),$('[data-get="settings"]').hammer().on("tap",function(e){e.stopPropagation(),e.preventDefault(),getSettings()}),$('[data-user="userid"]').hammer().on("tap",function(e){e.stopPropagation(),e.preventDefault(),getID()})}),$(function(){var e={prefetchLinks:function(){var e=$("a.prefetch").map(function(){return $(this).attr("href")});return $.unique(e)},addPrefetchTags:function(){this.prefetchLinks().each(function(e,t){$("<link />",{rel:"dns-prefetch",href:t}).appendTo("head")})}};$(function(){e.addPrefetchTags()})}),String.prototype.capitalise=function(){return this.charAt(0).toUpperCase()+this.slice(1)},String.prototype.hashCode=function(){var e,t,o,n=0;if(0==this.length)return n;for(e=0,o=this.length;o>e;e++)t=this.charCodeAt(e),n=(n<<5)-n+t,n|=0;return n};