function setStorage(){indexedDB?store.setDriver("IndexedDBWrapper").then(function(){console.log(store.driver+" IndexedDB")}):window.openDatabase?store.setDriver("WebSQLWrapper").then(function(){console.log(store.driver+" WebSQL")}):store.setDriver("localStorageWrapper").then(function(){console.log(store.driver+" LocalStorage")})}function online(){}function offline(){}function paused(){}function resumed(){}function addEventListeners(){document.addEventListener("touchstart",this,!1),document.addEventListener("touchmove",this,!1),document.addEventListener("touchend",this,!1),document.addEventListener("touchcancel",this,!1),document.addEventListener("online",online,!1),document.addEventListener("offline",offline,!1),document.addEventListener("pause",paused,!1),document.addEventListener("resume",resumed,!1)}var app={initialize:function(){this.bind()},bind:function(){document.addEventListener("deviceready",this.deviceready,!1)},deviceready:function(){addEventListeners(),setStorage()},report:function(e){console.log("report:"+e)}},header='<header role="banner" data-role="header" class="app-header container inner-wrap"><div role="button" data-role="button" class="menu-stack push"></div><nav role="navigation" data-role="navbar" class="main-menu menu-closed"><div class="nav-links"><a data-goto="#home" data-push="page" class="prefetch page"><i class="fa fa-border fa-home"></i>Home</a><a data-push="page" class="prefetch page"><i class="fa fa-border fa-location-arrow"></i>Nearby</a><a data-push="page" class="prefetch page"><i class="fa fa-border fa-shopping-cart"></i>Offers</a><a data-goto="#settings" data-push="page" class="prefetch page"><i class="fa fa-border fa-cog"></i>Settings</a></div></nav><div role="button" data-role="button" class="locate-button"></div></header>';$("body").prepend(header),$(document).on("deviceready",function(){document.addEventListener("backbutton",function(){function e(){return navigator.notification.confirm("Exit Visit Cheltenham "+device.cordova+" App?",function(e){1==e&&navigator.app.exitApp()},"Exit","Yes, No"),!1}e()},!1)}),$(function(){var e=$(".main-menu"),t=$("body"),a=$("#container"),o=$(".push"),n=$(".overlay"),r="menu-open",s="push-active",i="container-push",l="pushed",c=$(".menu-stack");app=$("#app"),handle="data-goto";var p=function(){t.toggleClass(s),e.toggleClass(r),a.toggleClass(i),o.toggleClass(l)};Modernizr.csstransforms3d&&(c.hammer().on("tap",function(){p()}),n.hammer().on("tap",function(){p()}),$("html").hammer().on("swipe",function(e){$(t).hasClass("push-active")||"right"!==e.gesture.direction?$(t).hasClass("push-active")&&"left"===e.gesture.direction&&(e.stopPropagation(),e.preventDefault(),p()):(e.stopPropagation(),e.preventDefault(),p())})),$currentPage=0===$("#app > .current").length?$("#settings").addClass("current"):$("#app > .current"),$('[data-push="page"]').hammer().on("tap",function(e){e.stopPropagation(),e.preventDefault(),p();var t=$(app).find(".current"),a=$(this).attr(handle);return $(t).removeClass("current"),$(a).addClass("current"),!1})}),$(function(){function e(){Modernizr.geolocation?GMaps.geolocate({success:function(e){var e={lat:e.coords.latitude,lng:e.coords.longitude};p=new google.maps.LatLng(e.lat,e.lng),console.log("locate button, currentLocation: "+p),o(),c.addMarker({lat:e.lat,lng:e.lng,icon:"img/location-marker-blue.png",animation:google.maps.Animation.DROP}),c.setCenter(e.lat,e.lng),c.setZoom(16),$(".no-results").remove()},error:function(e){t(),console.log("Geolocation failed: "+e.message)}}):(a(),console.log("This browser does not support geolocation"))}function t(){$(".location-map").append('<p class="no-geo message warning">Sorry, this feature isn\'t available right now.</p>'),setTimeout(function(){$(".no-geo").remove()},3500)}function a(){$(".location-map").append('<p class="no-geo message warning">Sorry, this feature isn\'t supported on your device.</p>')}function o(){c.removeMarkers()}function n(){r.html(""),s.html(""),o(),$(".no-results").remove(),c.setZoom(14),l&&i&&(l.setMap(null),i.setMap(null))}if(!Modernizr.geolocation)return a(),!1;var r=$(".results-names"),s=$(".results-distances");noResults=$(".results h1");var i,l,c,p,d,u=new google.maps.LatLng(51.902707,-2.073361),g=[{featureType:"road",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"poi",elementType:"labels",stylers:[{visibility:"simplified"}]},{featureType:"transit",elementType:"labels.text",stylers:[{visibility:"off"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#a2daf2"}]},{featureType:"landscape.man_made",elementType:"geometry",stylers:[{color:"#f7f1df"}]},{featureType:"landscape.natural",elementType:"geometry",stylers:[{color:"#d0e3b4"}]},{featureType:"landscape.natural.terrain",elementType:"geometry",stylers:[{visibility:"off"}]},{featureType:"poi.park",elementType:"geometry",stylers:[{color:"#bde6ab"}]},{featureType:"poi.medical",elementType:"geometry",stylers:[{color:"#fbd3da"}]},{featureType:"road",elementType:"geometry.stroke",stylers:[{visibility:"off"}]},{featureType:"road.highway",elementType:"geometry.fill",stylers:[{color:"#ffe15f"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#efd151"}]},{featureType:"road.arterial",elementType:"geometry.fill",stylers:[{color:"#ffffff"}]},{featureType:"road.local",elementType:"geometry.fill",stylers:[{color:"black"}]},{featureType:"transit.station.airport",elementType:"geometry.fill",stylers:[{color:"#cfb2db"}]}];c=new GMaps({div:"#map-container",center:u,zoom:14,disableDefaultUI:!0,styles:g,dragend:function(){console.log("dragend detected")}}),$(function(){Modernizr.geolocation?GMaps.geolocate({success:function(e){var e={lat:e.coords.latitude,lng:e.coords.longitude};p=new google.maps.LatLng(e.lat,e.lng),console.log("currentLocation: "+p)},error:function(e){$(".location-map").append('<p class="no-geo message warning">Sorry, we failed to get your current location.</p>'),console.log(e.message)}}):a()}),$(".locate-button").hammer().on("tap",function(a){a.stopPropagation(),a.preventDefault(),Modernizr.geolocation?e():t()}),$("#geocode-search").submit(function(e){e.stopPropagation(),e.preventDefault(),GMaps.geocode({address:$("#address").val().trim(),callback:function(e,t){if("OK"==t){o();var a=e[0].geometry.location;console.log(a),c.setCenter(a.lat(),a.lng()),c.addMarker({lat:a.lat(),lng:a.lng(),icon:"img/location-marker-pink.png",animation:google.maps.Animation.DROP})}else $("#address").focus(),console.log("oh no")}}),c.setZoom(19)}),$(".search-button").hammer().on("tap",function(e){e.stopPropagation(),e.preventDefault();var t=$("#place-query").val();return""==t?($("#place-query").focus(),$("#place-query").attr("placeholder","You didn't enter any terms")&&$("#place-query").addClass("plc-warning"),setTimeout(function(){$("#place-query").attr("placeholder","Search for places")&&$("#place-query").removeClass("plc-warning")},2800),!1):($("#place-search").submit(),void 0)}),$("#place-search").submit(function(e){e.stopPropagation(),e.preventDefault();var t=$("#place-query").val();return""==t?($("#place-query").focus(),$("#place-query").attr("placeholder","You didn't enter any terms")&&$("#place-query").addClass("plc-warning"),setTimeout(function(){$("#place-query").attr("placeholder","Search for places")&&$("#place-query").removeClass("plc-warning")},2800),!1):(c.addLayer("places",{location:u,radius:500,query:t,sensor:!0,language:"en-GB",textSearch:function(e,t){function a(e,t){if(t!=google.maps.DistanceMatrixStatus.OK)return!1;for(var a=e.originAddresses,o=e.destinationAddresses,n=0;n<a.length;n++)for(var r=e.rows[n].elements,i=0;i<r.length;i++){{var l=r[i],c=l.distance.text;l.duration.text,a[n],o[i]}s.append('<li class="distance">'+c+"</li>")}}if(t==google.maps.places.PlacesServiceStatus.OK){n();for(var o=new google.maps.LatLngBounds,g=0;g<e.length;g++){var f=e[g],m={url:f.icon,size:new google.maps.Size(71,71),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(17,34),scaledSize:new google.maps.Size(20,20)};r.append('<li class="name">'+f.name+"</li>"),d=p;var y=f.geometry.location,h=new google.maps.DistanceMatrixService;h.getDistanceMatrix({origins:[d],destinations:[y],travelMode:google.maps.TravelMode.WALKING,unitSystem:google.maps.UnitSystem.IMPERIAL,avoidHighways:!1,avoidTolls:!1},a),c.addMarker({lat:f.geometry.location.lat(),lng:f.geometry.location.lng(),icon:m,animation:google.maps.Animation.DROP,title:f.name,infoWindow:{content:"<h2>"+f.name+"</h2><p>"+(f.vicinity?f.vicinity:f.formatted_address)+"</p>"}}),o.extend(f.geometry.location)}c.fitBounds(o),i=c.drawCircle({center:u,radius:4,strokeColor:"#00adef",strokeOpacity:1,strokeWeight:8,fillColor:"#00adef",fillOpacity:1}),l=c.drawCircle({center:u,radius:500,strokeColor:"#00adef",strokeOpacity:1,strokeWeight:1,fillColor:"#808080",fillOpacity:.28})}else t==google.maps.places.PlacesServiceStatus.ZERO_RESULTS?(console.log(t),n(),noResults.after('<p class="warning no-results">Sorry, no places were found matching your search.</p>')):t==google.maps.places.PlacesServiceStatus.INVALID_REQUEST&&console.log(t)}}),google.maps.event.addListener(c,"bounds_changed",function(){var e=c.getBounds();$("#place-query").setBounds(e)}),void 0)})}),$(function(){var e,t,a;console.log(e+t+a),$(".save-settings").hammer().on("tap",function(e){e.stopPropagation(),e.preventDefault(),console.log(this,e+"saved")})}),$(function(){var e={prefetchLinks:function(){var e=$("a.prefetch").map(function(){return $(this).attr("href")});return $.unique(e)},addPrefetchTags:function(){this.prefetchLinks().each(function(e,t){$("<link />",{rel:"dns-prefetch",href:t}).appendTo("head")})}};$(function(){e.addPrefetchTags()})}),String.prototype.capitalise=function(){return this.charAt(0).toUpperCase()+this.slice(1)};
//# sourceMappingURL=main.min.js.map